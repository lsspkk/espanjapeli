================================================================================
ESPANJAPELI - UI/UX FIX LIST
================================================================================

Project: Mobile-First UI Polish & Finnish Language Consistency
Created: January 14, 2026
Priority: HIGH - User Experience Critical

These are small but important fixes to improve the user experience in the
Svelte application. Focus on mobile UX, Finnish language consistency, and
restoring better UI layouts that were lost in V4 updates.

================================================================================
TASK 20: Navigation Bar Mobile Improvements
================================================================================

DESCRIPTION:
Improve mobile navigation by hiding the main navbar in game modes (only show
"Takaisin" button), move the language learning link to main menu, and replace
text glyphs with proper icon images from Svelte icon packs.

OBJECTIVES:
□ Hide main navigation bar in game modes on mobile (only "Takaisin" visible)
□ Move "Kielten oppiminen" link from main page to main menu
□ Replace all text glyphs (emoji) in main menu with Svelte icon pack icons
  - Check installed: lucide-svelte, svelte-icons, or heroicons
  - Use consistent icon style throughout
□ Check that Asetukset & Tietojen vienti is in the main menu, and if it matches to the one that is currently on the footer, remove the link from footer
□ On mobile mainpage dont show Espanjapeli title, because it is already on the main navbar


AFFECTED FILES:
- svelte/src/lib/components/shared/Navbar.svelte
- svelte/src/routes/+page.svelte (main page)
- Game mode layouts (tarinat, yhdista-sanat, etc.)

TECHNICAL APPROACH:
- Add conditional rendering: hide navbar when in game mode on mobile
- Use CSS media queries: @media (max-width: 768px)
- Import icons from installed Svelte icon library
- Update menu items to use <Icon> components instead of emoji

ESTIMATED TIME: 2-3 hours


================================================================================
TASK 21: Finnish Language Consistency & Vocabulary Stats Widget
================================================================================

DESCRIPTION:
Fix language inconsistencies - all UI should be in Finnish, only learning
content in Spanish. Fix the Sanastosi widget issues: move to menu only,
fix button text, make word statistics clickable to show word lists.

OBJECTIVES:
□ Review ALL components for English text - replace with Finnish
  - Check: buttons, labels, error messages, tooltips
  - Document any English found in comments for tracking
  
□ Fix Sanastosi widget issues:
  - Move widget to menu only (remove from main page if present)
  - Change "Takaisin valikkoon" → "Takaisin" on back button
  - Remove glyph icon from main title "Sanastosi"
  - Add Svelte icon pack icons to statistic cards (not glyphs)
  
□ Make word counts clickable:
  - "Harjoitellut", "Osatut", etc. should be clickable
  - Click opens modal/dialog showing word list (sanakirja-style)
  - Dialog shows: word in Spanish, Finnish translation
  - Close button to return to statistics

AFFECTED FILES:
- svelte/src/lib/components/shared/VocabularyProgressWidget.svelte
- svelte/src/routes/sanasto/+page.svelte
- All game mode components (check for English strings)
- Modal component for word list (create if needed)

NEW COMPONENT:
- Create: VocabularyWordListDialog.svelte
  - Props: words[], title, onClose
  - Shows list of words with Spanish + Finnish
  - Scrollable if many words
  - Mobile-friendly touch targets

ESTIMATED TIME: 3-4 hours


================================================================================
TASK 22: Story Mode UI Improvements
================================================================================

DESCRIPTION:
Add filtering/sorting UI for stories, restore the better question interface
that existed before V4 updates. The old two-column layout was much better
than the current card-based layout.

OBJECTIVES:
□ Create story filtering/sorting component:
  - Filter by difficulty (A1, A2, B1, all)
  - Sort by: alphabet, difficulty
  - Mobile: dropdown/select
  - Desktop: button group or tabs
  - All text in Finnish
  
□ Restore old story question UI:
  - Research: git diff to see old layout from main branch
  - Old layout: two-column format (not cards)
  - Old layout had special formatting that was better
  - Restore that layout structure
  - Keep V4 data model, but use old UI layout

AFFECTED FILES:
- svelte/src/routes/tarinat/+page.svelte (story list)
- svelte/src/lib/components/story/StoryReader.svelte (questions)
- New: StoryFilterSort.svelte component

TECHNICAL APPROACH:
1. Git comparison:
   - Check main branch: svelte/src/lib/components/story/
   - Find old StoryQuestion or StoryReader layout
   - Document what made it better (columns, spacing, etc.)
   
2. Create filter/sort component:
   - Use DaisyUI dropdown for mobile
   - Use button group for desktop
   - Emit events to parent for filtering
   
3. Restore question layout:
   - Recreate two-column structure
   - Apply old CSS/styling
   - Test on mobile


================================================================================
TASK 23: DaisyUI Theme Usage Analysis and Fix
================================================================================

DESCRIPTION:
Review and analyze the current DaisyUI theme implementation. Many users report
that most themes appear to have dark backgrounds when they shouldn't. Analyze
the theme configuration, usage patterns, and identify why this is happening.
Document findings and create fix subtasks based on the analysis.

OBJECTIVES:
□ Review DaisyUI theme configuration and available themes
□ Analyze theme.ts store implementation
□ Check how themes are applied in +layout.svelte
□ Examine bg-base-200, bg-base-100 usage across components
□ Test all 14 available themes (light, cupcake, bumblebee, emerald, etc.)
□ Document why most themes show dark backgrounds
□ Identify incorrect theme usage patterns
□ Write findings to reports/task-23-theme-usage-report.md

AFFECTED FILES:
- svelte/src/lib/stores/theme.ts (theme store)
- svelte/src/routes/+layout.svelte (theme application)
- svelte/src/routes/asetukset/+page.svelte (theme settings)
- All components using bg-base-* classes
- DaisyUI configuration (if exists)

ANALYSIS AREAS:
1. Theme Store Configuration:
   - Check available themes list
   - Verify default theme
   - Review localStorage persistence
   
2. Theme Application:
   - How data-theme attribute is set
   - Check if themes are properly loaded
   - Verify DaisyUI is correctly configured
   
3. Component Patterns:
   - Usage of bg-base-200 (background)
   - Usage of bg-base-100 (cards/surfaces)
   - Usage of text-base-content
   - Check for hardcoded colors
   
4. Testing Matrix:
   - Test each theme visually
   - Document which themes work correctly
   - Identify themes with dark background issues

DELIVERABLES:
□ reports/task-23-theme-usage-report.md with:
  - Current theme implementation analysis
  - List of themes and their actual appearance
  - Root cause of dark background issue
  - Recommendations for fixes
□ Subtasks added to TODO.txt based on findings
□ Priority level for fixes (if critical)

ESTIMATED TIME: 2-3 hours for analysis, variable for fixes


================================================================================
TASK 24: Kids/Basic Knowledge Separation & Vocabulary Progress Implementation
================================================================================

DESCRIPTION:
Implement separate vocabulary tracking for kids and basic game modes to support
multiple users (kids + adults) on the same device. Analyze current data model
usage across all games, implement proper knowledge separation in localStorage,
and create kids-specific vocabulary statistics UI with encouraging messaging.

OBJECTIVES:

□ SUBTASK 24.1: Data Model Analysis & Architecture Design
  - Analyze current wordKnowledge store usage across ALL game modes
  - Identify which games use spanish_to_finnish vs finnish_to_spanish tracking
  - Document current localStorage structure for word knowledge
  - Design separation strategy: kids vs basic knowledge tracking
  - Determine if kids games should have separate localStorage keys
  - Consider data migration strategy for existing users
  - Analyze if current statisticsService supports dual tracking
  - Write findings to: reports/knowledge-implementation-report.txt
  - Include recommendations for:
    * localStorage key naming (e.g., wordKnowledge_kids, wordKnowledge_basic)
    * Data model structure changes needed
    * Migration path for existing data
    * Service layer changes required
  
□ SUBTASK 24.2: Implement Knowledge Separation in Data Layer
  - Update wordKnowledge store to support mode parameter (kids/basic)
  - Create separate localStorage keys for kids and basic progress
  - Update recordAnswer() to accept mode parameter
  - Update getWordScore() to query correct knowledge store
  - Modify statisticsService to calculate stats per mode
  - Add data migration function for existing users
  - Update all game modes to pass correct mode parameter:
    * sanapeli → basic
    * yhdistasanat → basic
    * tarinat → basic
    * pipsan-maailma → kids
    * pipsan-ystavat → kids
  - Write unit tests for dual tracking
  
□ SUBTASK 24.3: Integrate Progress Tracking in Games
  - Review V4_TODO.txt for progress indicator components
  - Ensure all games call wordKnowledge.recordAnswer() correctly
  - Verify sanapeli tracks word knowledge after each answer
  - Verify yhdistasanat tracks word knowledge after each answer
  - Verify tarinat tracks vocabulary from story content
  - Verify pipsan-maailma tracks kids vocabulary
  - Verify pipsan-ystavat tracks kids vocabulary
  - Add missing progress tracking where needed
  - Test that statistics update in real-time during gameplay
  - Verify localStorage persistence after game completion
  
□ SUBTASK 24.4: Create Kids Vocabulary Statistics Page (sanasto-kids)
  - Create new route: svelte/src/routes/sanasto-kids/+page.svelte
  - Use kids-themed components (large text, bright colors, animations)
  - Show kids-specific vocabulary statistics:
    * Total words learned
    * Words practiced today
    * Favorite words (most practiced)
    * Progress visualization (kid-friendly charts/animations)
  - Add encouraging messages:
    * "Olet todella taitava!" (You are really skillful!)
    * "Loistavaa työtä!" (Great work!)
    * "Olet oppimassa uusia sanoja!" (You are learning new words!)
  - Use Peppa Pig theme colors and styling
  - Include character animations for celebration
  - Make all statistics interactive and fun
  - Add sound effects for interactions (optional)
  
□ SUBTASK 24.5: Create Kids Vocabulary Widget for Front Page
  - Create: svelte/src/lib/components/kids/KidsVocabularyWidget.svelte
  - Design circular/bubble widget similar to basic widget but kid-themed
  - Position on kids game mode pages (pipsan-maailma, pipsan-ystavat)
  - Show simplified statistics:
    * Number of words learned (large, colorful number)
    * Fun progress indicator (stars, hearts, or similar)
    * Animated character icon
  - Widget acts as link to /sanasto-kids
  - Use bright colors, large touch targets
  - Add hover/tap animations
  - Include encouraging emoji or character graphics
  - Ensure mobile-friendly (kids use touch screens)
  - Widget only shows if kids have practiced words
  
□ SUBTASK 24.6: Update Front Page with Kids Widget
  - Add KidsVocabularyWidget to kids game mode pages
  - Position widget appropriately (not conflicting with basic widget)
  - Ensure widget only shows on kids game pages
  - Test on mobile devices (primary kids usage)
  - Verify navigation to sanasto-kids works correctly

AFFECTED FILES:
- svelte/src/lib/stores/wordKnowledge.ts (core data model)
- svelte/src/lib/services/statisticsService.ts (stats calculation)
- svelte/src/routes/sanapeli/+page.svelte (basic game)
- svelte/src/routes/yhdistasanat/+page.svelte (basic game)
- svelte/src/routes/tarinat/+page.svelte (basic game)
- svelte/src/routes/pipsan-maailma/+page.svelte (kids game)
- svelte/src/routes/pipsan-ystavat/+page.svelte (kids game)
- svelte/src/routes/sanasto-kids/+page.svelte (NEW)
- svelte/src/lib/components/kids/KidsVocabularyWidget.svelte (NEW)
- reports/knowledge-implementation-report.txt (NEW - analysis output)

TECHNICAL APPROACH:
1. Analysis Phase:
   - Grep for wordKnowledge usage across codebase
   - Document current data flow
   - Design separation architecture
   
2. Implementation Phase:
   - Update stores with mode parameter
   - Modify services to support dual tracking
   - Update game components to pass mode
   - Create migration function
   
3. UI Phase:
   - Create kids statistics page with encouraging design
   - Create kids widget with fun animations
   - Integrate widgets into appropriate pages
   
4. Testing Phase:
   - Test data separation (kids data doesn't affect basic)
   - Test migration for existing users
   - Test all games record progress correctly
   - Test kids UI on mobile devices

ESTIMATED TIME: 8-12 hours (complex multi-component task)